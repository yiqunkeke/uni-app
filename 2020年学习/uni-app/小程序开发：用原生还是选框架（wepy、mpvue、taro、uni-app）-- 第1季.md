# 小程序开发：用原生还是选框架

- 自2017年1月9号，微信小程序诞生以来，历经2年多的迭代升级，已有数百万小程序上线，成为继 **Web、IOS、Android**之后，第**4大主流开发技术**。

- 小程序的开发生态也在蓬勃发展，从刀耕火种演进为现代化开发，生态也越来越丰富。

- 选择多了，问题也就来了：开发小程序，该用原生还是选择三方框架？

  

## 微信原生开发槽点

- 原生开发对 Node、预编译器、Webpack 支持不好，影响开发效率和工程构建流程。

- 微信定义了一个**不伦不类的语法**，不如正经学vue,react，学会了全端通用，而不是只为小程序。

- 微信IDE和专业的**编辑器**相比**实在不好用**。

- 没有正经的状态管理

- vue/react有太多周边工具，可以提高开发效率。

  

## 小程序框架选型思路

- 面向用户：提供完整的业务实现，并保证高性能体验
- 面向开发者：平缓的学习曲线、现代开发体验（工程化）、高效的社区支持、活跃的开发迭代、多端复用



### 功能实现

- 软件开发，首要**目标**是向用户提供**完整、闭环的业务**功能。
- 在web开发中，如果vue、react 等框架的使用，造成开发者无法操作浏览器提供的所有api，那这样的框架肯定是不成熟的。小程序开发也一样，任何开发框架都**不能限制底层的api调用**。
- 各种业务功能底层依赖微信暴露的组件和接口。（微信官网介绍的组件和API规范，也叫**微信原生**API），三方框架是基于微信原生进行的二次封装。开发者此时常会有个疑问：小程序在不断的迭代升级，如果某项业务依赖于最新的小程序API，但三方框架尚未封装，该怎么办？
- 实际上就像web开发中使用 vue、react一样，浏览器新出了一个API，并不会涉及vue、react的升级。
- 三方框架 wepy、mpvue、taro、uni-app均可调用所有小程序API，完成用户的业务需求。这个维度无差别，然而有差别的，是性能体验。



### 性能体验

- 三方框架，内部大多做了层层封装，这些封装是否会增加运行负载，导致性能下降？尤其是与原生微信小程序开发相比，性能怎么样？这是大家普遍关心的问题。
- 经测试：微信原生手工优化，uni-app > 微信原生开发未手工优化, taro > wepy > mpvue



### 学习曲线

- 选择开发团队熟悉的、能快速上手的DSL，是团队框架选型的基本点。
- 首先微信原生的开发语法，既像React，又像 Vue，有点不伦不类，对于开发者来说，等于又要学习一套新的语法，大幅提升了学习成本，这一直被大家所诟病。
- 其它开发框架基本都遵循React、Vue（类vue）语法，其主要目的：复用工程师的现有技术栈，**降低学习成本**。此时，框架对于原框架（React/Vue）语法的支持度就是一个重要的衡量标准，如果支持度较低、和原框架语法差异较大，则开发者无异于要学习一门新的框架，成本太高。
- 实际开发中发现，各个开发框架，都没有完全实现对 Vue、React 在web上的所有语法。

>`wepy`开发风格接近于 `Vue.js`，属于`类Vue`实现，相对微信原生开发算前进了一大步，但相比完整`Vue`语法还有较大差距，开发时需要单独学习它的规则；
>
>`mpvue`、`uni-app` 框架基于 `Vue.js` 核心，通过修改 `Vue.js` 的 `runtime` 和 `compiler`，实现了在小程序端的运行。`mpvue`支持的Vue语法略少，`uni-app` 则基本支持绝大多数vue语法，如`filter`、复杂 `JavaScript` 表达式等；
>
>`taro` 对于 `JSX` 的语法支持度，也达到了绝大多数都支持的完善程度。



DSL语法支持评测：`taro`,`uni-app` > `mpvue` > `wepy` > 微信原生



## 结语

真实客观的永远是实验和数据，而不是结论。不同需求的开发者，可以根据上述实验数据，自行得出自己的选型结论。

但作为一篇完整的评测，我们也必须提供一份总结，虽然它可能加入了我们的主观感受：

如果你只开发微信小程序，不做多端，那么使用`uni-app`、`taro`是更优的选择，他们相当于web世界的vue和react，有了这些工具，不再需要使用原生wxml开发。

- 如果坚持微信原生开发，需要注意手动写优化代码来控制`setdata`，并且注意其工程化能力非常弱
- 如果你是`react`系，那就用`taro`
- 如果是`vue`系，那就用`uni-app`，`uni-app`在性能、周边生态和开发效率上更有优势

如果你开发多端，`uni-app`和`taro`都可以，可根据自己熟悉的技术栈选择，相对而言`uni-app`的多端成熟度更高一些。









